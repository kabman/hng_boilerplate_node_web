paths:
  /auth/login:
    post:
      tags:
      - Auth
      summary: User login
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/auth_login_body'
        required: true
      responses:
        "200":
          description: Successful login
        "401":
          description: Invalid credentials
        "422":
          description: Invalid input
  /auth/register:
    post:
      tags:
      - Auth
      summary: User registration
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/auth_register_body'
        required: true
      responses:
        "201":
          description: User registered successfully
        "422":
          description: Invalid input/User already exists
  /auth/social:
    post:
      tags:
      - Auth
      summary: Social authentication
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/auth_social_body'
        required: true
      responses:
        "200":
          description: Successful authentication
        "401":
          description: Invalid credentials
  /auth/magic-link:
    post:
      tags:
      - Auth
      summary: Magic link authentication
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/auth_magiclink_body'
        required: true
      responses:
        "200":
          description: Check email for magic link
        "401":
          description: Invalid email
  /auth/forgot-password:
    post:
      tags:
      - Auth
      summary: Forgot password
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/auth_forgot_password_body'
        required: true
      responses:
        "200":
          description: Check email to reset password
        "401":
          description: Invalid email
  /auth/reset-password:
    post:
      tags:
      - Auth
      summary: Reset password
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/auth_reset_password_body'
        required: true
      responses:
        "200":
          description: Password reset is successful
        "401":
          description: Token has expired
  /auth/verify-email:
    post:
      tags:
      - Auth
      summary: Verify user's email
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/auth_verify_email_body'
        required: true
      responses:
        "200":
          description: Email verified successfully
        "401":
          description: Invalid token
  /auth/resend-token:
    post:
      tags:
      - Auth
      summary: Resend email with token
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/auth_resend_token_body'
        required: true
      responses:
        "200":
          description: Check email for new token
        "401":
          description: Invalid email
  /auth/change-password:
    post:
      tags:
      - Auth
      summary: Change password
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/auth_changepassword_body'
        required: true
      responses:
        "200":
          description: Password changed successfully
        "401":
          description: wrong old password
        "422":
          description: invalid input
components:
  schemas:
    auth_login_body:
      type: object
      properties:
        email:
          type: string
        password:
          type: string
    auth_register_body:
      type: object
      properties:
        email:
          type: string
        password:
          type: string
        firstname:
          type: string
        lastname:
          type: string
        phone:
          type: string
    auth_social_body:
      type: object
      properties:
        provider:
          type: string
        token:
          type: string
    auth_magiclink_body:
      type: object
      properties:
        email:
          type: string
    auth_forgot_password_body:
      type: object
      properties:
        email:
          type: string
    auth_resend_token_body:
      type: object
      properties:
        email:
          type: string
    auth_reset_password_body:
      type: object
      properties:
        password:
          type: string
        token:
          type: string
    auth_verify_email_body:
      type: object
      properties:
        token:
          type: string
    auth_changepassword_body:
      type: object
      properties:
        oldPassword:
          type: string
        newPassword:
          type: string
